meta {
  name: 05-add-btc-invoice
  type: http
  seq: 5
}

post {
  url: {{LND_BOB_RPC_URL}}/v1/invoices
  body: json
  auth: none
}

body:json {
  {"value":100}
}

assert {
  res.status: eq 200
  res.body.payment_request: isDefined
  res.body.r_hash: isDefined
}

script:post-response {
  bru.setVar("BTC_PAY_REQ", res.body.payment_request);
  const payment_hash = Buffer.from(res.body.r_hash, 'base64').toString('hex');
  console.log(payment_hash);
  bru.setVar("PAYMENT_HASH", `0x${payment_hash}`);
  bru.setVar("PAYMENT_HASH_NO_0x", payment_hash);
}

docs {
  BTC user generates an invoice via lnd.
}
